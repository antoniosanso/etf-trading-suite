# Repository Content Index — antoniosanso/etf-trading-suite@main

Questa pagina è generata automaticamente dal workflow **Content Indexer**.

| Path | Size | SHA (short) | Link | Raw |
|---|---:|---|---|---|

| `.github/workflows/backtest_matrix.yml` | 3,135 | `06ce210c` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/.github/workflows/backtest_matrix.yml) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/.github/workflows/backtest_matrix.yml) |
| `.github/workflows/content_index.yml` | 1,451 | `e65d17be` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/.github/workflows/content_index.yml) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/.github/workflows/content_index.yml) |
| `.github/workflows/content_mirror.yml` | 815 | `7d9497a7` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/.github/workflows/content_mirror.yml) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/.github/workflows/content_mirror.yml) |
| `.github/workflows/dataset.yml` | 2,538 | `6f505c82` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/.github/workflows/dataset.yml) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/.github/workflows/dataset.yml) |
| `.github/workflows/remove_legacy_eod.yml` | 1,584 | `30c0939d` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/.github/workflows/remove_legacy_eod.yml) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/.github/workflows/remove_legacy_eod.yml) |
| `.github/workflows/retro_asof.yml` | 3,438 | `9edaf0a2` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/.github/workflows/retro_asof.yml) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/.github/workflows/retro_asof.yml) |
| `.github/workflows/snapshot_workflows.yml` | 1,056 | `5c0a353a` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/.github/workflows/snapshot_workflows.yml) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/.github/workflows/snapshot_workflows.yml) |
| `.github/workflows/status_poster.yml` | 3,181 | `855b672d` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/.github/workflows/status_poster.yml) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/.github/workflows/status_poster.yml) |
| `.github/workflows/trading_suite.yml` | 5,791 | `39f098ef` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/.github/workflows/trading_suite.yml) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/.github/workflows/trading_suite.yml) |
| `.github/workflows/unified.yml` | 748 | `0e72a0b8` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/.github/workflows/unified.yml) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/.github/workflows/unified.yml) |
| `.github/workflows/universe_fetch.yml` | 861 | `cd0c6ec8` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/.github/workflows/universe_fetch.yml) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/.github/workflows/universe_fetch.yml) |
| `CLEANUP.md` | 296 | `60a5e4ad` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/CLEANUP.md) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/CLEANUP.md) |
| `DECISIONS.md` | 511 | `4048f347` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/DECISIONS.md) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/DECISIONS.md) |
| `PATCH_NOTES.md` | 997 | `cb73d02d` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/PATCH_NOTES.md) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/PATCH_NOTES.md) |
| `README.md` | 1,427 | `bef8a03b` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/README.md) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/README.md) |
| `README_DATASET.txt` | 501 | `f0682d92` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/README_DATASET.txt) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/README_DATASET.txt) |
| `README_MULTILAYER_BACKTEST.md` | 455 | `3308db46` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/README_MULTILAYER_BACKTEST.md) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/README_MULTILAYER_BACKTEST.md) |
| `README_OPS.md` | 1,444 | `059b11e3` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/README_OPS.md) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/README_OPS.md) |
| `README_PUBLISH_TO_DATALAKE.txt` | 778 | `8275b856` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/README_PUBLISH_TO_DATALAKE.txt) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/README_PUBLISH_TO_DATALAKE.txt) |
| `README_RETRO_ASOF.txt` | 469 | `3cb6bee7` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/README_RETRO_ASOF.txt) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/README_RETRO_ASOF.txt) |
| `README_WEB_INGEST.txt` | 461 | `a3997748` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/README_WEB_INGEST.txt) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/README_WEB_INGEST.txt) |
| `RUNBOOK.md` | 647 | `df0781b6` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/RUNBOOK.md) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/RUNBOOK.md) |
| `docs/CONTENT_INDEX.md` | 48,084 | `d09948b9` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/docs/CONTENT_INDEX.md) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/docs/CONTENT_INDEX.md) |
| `docs/UNIFIED_AUTOMATION_PATCH.md` | 2,091 | `75e35245` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/docs/UNIFIED_AUTOMATION_PATCH.md) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/docs/UNIFIED_AUTOMATION_PATCH.md) |
| `docs/UNIVERSE_PIPELINE.md` | 978 | `924a8c9b` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/docs/UNIVERSE_PIPELINE.md) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/docs/UNIVERSE_PIPELINE.md) |
| `etf-trading-config/README.md` | 45 | `b2860f67` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-config/README.md) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-config/README.md) |
| `etf-trading-config/features.yaml` | 370 | `30f6ce65` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-config/features.yaml) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-config/features.yaml) |
| `etf-trading-config/mappings/etf_topics.csv` | 45 | `79e5d256` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-config/mappings/etf_topics.csv) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-config/mappings/etf_topics.csv) |
| `etf-trading-config/mappings/yf_overrides.csv` | 66 | `860f1334` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-config/mappings/yf_overrides.csv) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-config/mappings/yf_overrides.csv) |
| `etf-trading-config/model.stopcriteria.patch.yaml` | 127 | `7f6abd17` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-config/model.stopcriteria.patch.yaml) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-config/model.stopcriteria.patch.yaml) |
| `etf-trading-config/model.yaml` | 2,614 | `8cf3b2ff` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-config/model.yaml) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-config/model.yaml) |
| `etf-trading-config/news_sources.yaml` | 739 | `a3169e0d` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-config/news_sources.yaml) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-config/news_sources.yaml) |
| `etf-trading-config/operational.yaml` | 397 | `4260abc2` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-config/operational.yaml) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-config/operational.yaml) |
| `etf-trading-config/schedules.md` | 612 | `f21f84b6` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-config/schedules.md) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-config/schedules.md) |
| `etf-trading-config/signals.yaml` | 507 | `a5dbe834` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-config/signals.yaml) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-config/signals.yaml) |
| `etf-trading-config/signals.yaml.append` | 78 | `5e93f5af` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-config/signals.yaml.append) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-config/signals.yaml.append) |
| `etf-trading-config/universe.csv` | 23 | `8385e221` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-config/universe.csv) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-config/universe.csv) |
| `etf-trading-config/wf_windows.yaml` | 604 | `5f2dc29b` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-config/wf_windows.yaml) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-config/wf_windows.yaml) |
| `etf-trading-engine/README.md` | 62 | `794d5f0e` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/README.md) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/README.md) |
| `etf-trading-engine/examples/portfolio_cli.py` | 845 | `3ab7c0a3` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/examples/portfolio_cli.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/examples/portfolio_cli.py) |
| `etf-trading-engine/examples/run_backtest.py` | 656 | `20bc2b7c` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/examples/run_backtest.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/examples/run_backtest.py) |
| `etf-trading-engine/requirements.txt` | 110 | `2e5177a8` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/requirements.txt) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/requirements.txt) |
| `etf-trading-engine/scripts/aggregate_fundamentals.py` | 3,279 | `776047fc` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/scripts/aggregate_fundamentals.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/scripts/aggregate_fundamentals.py) |
| `etf-trading-engine/scripts/aggregate_news.py` | 3,998 | `7423a1b4` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/scripts/aggregate_news.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/scripts/aggregate_news.py) |
| `etf-trading-engine/scripts/append_reports.py` | 1,234 | `6dbeef6a` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/scripts/append_reports.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/scripts/append_reports.py) |
| `etf-trading-engine/scripts/build_features.py` | 3,501 | `35857810` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/scripts/build_features.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/scripts/build_features.py) |
| `etf-trading-engine/scripts/clip_asof.py` | 891 | `813ee523` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/scripts/clip_asof.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/scripts/clip_asof.py) |
| `etf-trading-engine/scripts/download_eod_yf.py` | 3,177 | `31ac5667` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/scripts/download_eod_yf.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/scripts/download_eod_yf.py) |
| `etf-trading-engine/scripts/fetch_file.py` | 2,497 | `b21d1d1c` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/scripts/fetch_file.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/scripts/fetch_file.py) |
| `etf-trading-engine/scripts/fetch_universe.py` | 4,119 | `45284416` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/scripts/fetch_universe.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/scripts/fetch_universe.py) |
| `etf-trading-engine/scripts/generate_status.py` | 1,184 | `6f8a81ec` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/scripts/generate_status.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/scripts/generate_status.py) |
| `etf-trading-engine/scripts/guardrails.py` | 4,139 | `d269e80b` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/scripts/guardrails.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/scripts/guardrails.py) |
| `etf-trading-engine/scripts/index_repo.py` | 5,739 | `9fcdf415` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/scripts/index_repo.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/scripts/index_repo.py) |
| `etf-trading-engine/scripts/kpi_aggregator.py` | 1,572 | `c3bcefdb` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/scripts/kpi_aggregator.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/scripts/kpi_aggregator.py) |
| `etf-trading-engine/scripts/merge_eod.py` | 5,297 | `8fafb3ac` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/scripts/merge_eod.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/scripts/merge_eod.py) |
| `etf-trading-engine/scripts/operational_report.py` | 6,819 | `66f0ab54` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/scripts/operational_report.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/scripts/operational_report.py) |
| `etf-trading-engine/scripts/portfolio_tools.py` | 1,053 | `93275c90` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/scripts/portfolio_tools.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/scripts/portfolio_tools.py) |
| `etf-trading-engine/scripts/publish_dataset.py` | 1,491 | `5e30cd1c` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/scripts/publish_dataset.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/scripts/publish_dataset.py) |
| `etf-trading-engine/scripts/retro_evaluate.py` | 8,498 | `6fc86125` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/scripts/retro_evaluate.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/scripts/retro_evaluate.py) |
| `etf-trading-engine/scripts/run_ci_backtest.py` | 1,117 | `f83cb15f` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/scripts/run_ci_backtest.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/scripts/run_ci_backtest.py) |
| `etf-trading-engine/scripts/sanity_check.py` | 1,986 | `b544dadf` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/scripts/sanity_check.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/scripts/sanity_check.py) |
| `etf-trading-engine/scripts/signals.py` | 6,656 | `7aa9136b` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/scripts/signals.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/scripts/signals.py) |
| `etf-trading-engine/scripts/signals_finalize_patch.py` | 1,102 | `53d1e35e` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/scripts/signals_finalize_patch.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/scripts/signals_finalize_patch.py) |
| `etf-trading-engine/scripts/signals_patch.py` | 1,170 | `cbca8d88` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/scripts/signals_patch.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/scripts/signals_patch.py) |
| `etf-trading-engine/scripts/walk_forward.py` | 3,636 | `f85df413` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/scripts/walk_forward.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/scripts/walk_forward.py) |
| `etf-trading-engine/src/__init__.py` | 0 | `e69de29b` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/src/__init__.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/src/__init__.py) |
| `etf-trading-engine/src/engine/__init__.py` | 35 | `e4831d51` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/src/engine/__init__.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/src/engine/__init__.py) |
| `etf-trading-engine/src/engine/backtest.py` | 1,397 | `c4aad60f` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/src/engine/backtest.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/src/engine/backtest.py) |
| `etf-trading-engine/src/engine/indicators.py` | 522 | `af7c58ee` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/src/engine/indicators.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/src/engine/indicators.py) |
| `etf-trading-engine/src/engine/metrics.py` | 742 | `99d7a0ca` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/src/engine/metrics.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/src/engine/metrics.py) |
| `etf-trading-engine/src/engine/strategy.py` | 600 | `0ae9de38` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/src/engine/strategy.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/src/engine/strategy.py) |
| `etf-trading-engine/tests/test_smoke.py` | 311 | `b7f0d3ae` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/etf-trading-engine/tests/test_smoke.py) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/etf-trading-engine/tests/test_smoke.py) |
| `reports/daily/2025-10-09/guardrails_status.json` | 1,902 | `c026cf25` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-09/guardrails_status.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-09/guardrails_status.json) |
| `reports/daily/2025-10-09/kpis.json` | 142 | `6ed3aef4` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-09/kpis.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-09/kpis.json) |
| `reports/daily/2025-10-09/wf_report.json` | 1,328 | `fc32a334` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-09/wf_report.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-09/wf_report.json) |
| `reports/daily/2025-10-10/guardrails_status.json` | 1,908 | `c1e669cc` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-10/guardrails_status.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-10/guardrails_status.json) |
| `reports/daily/2025-10-10/kpis.json` | 143 | `3afe5ecb` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-10/kpis.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-10/kpis.json) |
| `reports/daily/2025-10-10/wf_report.json` | 1,331 | `a3596d7a` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-10/wf_report.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-10/wf_report.json) |
| `reports/daily/2025-10-11/guardrails_status.json` | 1,906 | `7905e28a` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-11/guardrails_status.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-11/guardrails_status.json) |
| `reports/daily/2025-10-11/kpis.json` | 143 | `5666b17c` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-11/kpis.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-11/kpis.json) |
| `reports/daily/2025-10-11/wf_report.json` | 1,329 | `daa86e07` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-11/wf_report.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-11/wf_report.json) |
| `reports/daily/2025-10-12/guardrails_status.json` | 1,904 | `59090706` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-12/guardrails_status.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-12/guardrails_status.json) |
| `reports/daily/2025-10-12/kpis.json` | 143 | `b2f4ec88` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-12/kpis.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-12/kpis.json) |
| `reports/daily/2025-10-12/wf_report.json` | 1,329 | `34c38986` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-12/wf_report.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-12/wf_report.json) |
| `reports/daily/2025-10-13/guardrails_status.json` | 1,904 | `3955cbf0` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-13/guardrails_status.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-13/guardrails_status.json) |
| `reports/daily/2025-10-13/kpis.json` | 143 | `b2f4ec88` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-13/kpis.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-13/kpis.json) |
| `reports/daily/2025-10-13/wf_report.json` | 1,329 | `ff1d06bc` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-13/wf_report.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-13/wf_report.json) |
| `reports/daily/2025-10-14/guardrails_status.json` | 1,901 | `663f89d7` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-14/guardrails_status.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-14/guardrails_status.json) |
| `reports/daily/2025-10-14/kpis.json` | 142 | `0dbfe56d` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-14/kpis.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-14/kpis.json) |
| `reports/daily/2025-10-14/wf_report.json` | 1,327 | `ddfc8286` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-14/wf_report.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-14/wf_report.json) |
| `reports/daily/2025-10-15/guardrails_status.json` | 1,900 | `41bbe69e` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-15/guardrails_status.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-15/guardrails_status.json) |
| `reports/daily/2025-10-15/kpis.json` | 141 | `cb1387bb` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-15/kpis.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-15/kpis.json) |
| `reports/daily/2025-10-15/wf_report.json` | 1,327 | `6f51abf1` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-15/wf_report.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-15/wf_report.json) |
| `reports/daily/2025-10-16/guardrails_status.json` | 2,353 | `8a644bec` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-16/guardrails_status.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-16/guardrails_status.json) |
| `reports/daily/2025-10-16/kpis.json` | 94 | `bdf6dfa3` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-16/kpis.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-16/kpis.json) |
| `reports/daily/2025-10-16/wf_report.json` | 1,738 | `a65bfefc` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-16/wf_report.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-16/wf_report.json) |
| `reports/daily/2025-10-17/guardrails_status.json` | 2,353 | `8a644bec` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-17/guardrails_status.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-17/guardrails_status.json) |
| `reports/daily/2025-10-17/kpis.json` | 94 | `bdf6dfa3` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-17/kpis.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-17/kpis.json) |
| `reports/daily/2025-10-17/wf_report.json` | 1,738 | `a65bfefc` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-17/wf_report.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-17/wf_report.json) |
| `reports/daily/2025-10-18/guardrails_status.json` | 2,353 | `8a644bec` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-18/guardrails_status.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-18/guardrails_status.json) |
| `reports/daily/2025-10-18/kpis.json` | 94 | `bdf6dfa3` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-18/kpis.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-18/kpis.json) |
| `reports/daily/2025-10-18/wf_report.json` | 1,738 | `a65bfefc` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/daily/2025-10-18/wf_report.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/daily/2025-10-18/wf_report.json) |
| `reports/history/kpis.jsonl` | 3,944 | `e7b8a9c5` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/history/kpis.jsonl) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/history/kpis.jsonl) |
| `reports/history/wf.jsonl` | 28,053 | `63eb85dd` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/history/wf.jsonl) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/history/wf.jsonl) |
| `reports/latest.json` | 4,638 | `f278e28a` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/reports/latest.json) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/reports/latest.json) |

## Estratti e Headings

### `.github/workflows/backtest_matrix.yml`

```text
name: Backtest via Web Ingest (alias buffer key)

on:
  workflow_dispatch: {}

jobs:
  backtest-all:
    runs-on: ubuntu-latest
    env:
      PYTHONPATH: etf-trading-engine
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: "3.11"
      - name: Install deps
        run: python -m pip install -r etf-trading-engine/requirements.txt pyyaml
      - name: Download EOD from Yahoo
        run: |
          python etf-trading-engine/scripts/download_eod_yf.py             --universe etf-trading-config/universe.csv             --output etf-trading-engine/data/eod.csv             --start 2018-01-01             --threads 1 --sleep 1 --min_success 2
      - name: Sanity check
        run: python etf-trading-engine/scripts/sanity_check.py --data etf-trading-engine/data/eod.csv
      - name: Build runtime config (inject params incl. alias)
        run: |
          python - << 'PY'
          import yaml, os
          src = "etf-trading-config/model.yaml"
          dst = "etf-trading-config/model_runtime.yaml"
          with open(src, "r", encoding="utf-8") as f:
              cfg = yaml.safe_load(f) or {}
          # ensure top-level
          params = cfg.get("params") or {}
          atr = params.get("atr_pct", 1.0)
          buf = params.get("buffer_mul", params.get("buffer_mult", 1.0))
          params["atr_pct"] = atr
          params["buffer_mul"] = buf
          params["buffer_mult"] = buf   # alias per eventuale richiesta con 't'
          cfg["params"] = params
          # ensure inside each run
```

### `.github/workflows/content_index.yml`

```text
name: Content Indexer
on:
  push:
    branches: [ "main" ]
  workflow_dispatch:
  schedule:
    - cron: "40 6 * * *"
permissions:
  contents: write
  pages: write
  id-token: write
jobs:
  index-and-publish:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: "3.11"
      - run: |
          python -m pip install --upgrade pip
          pip install requests
      - name: Build repo content index
        run: |
          python etf-trading-engine/scripts/index_repo.py \
            --repo ${{ github.repository }} \
            --ref ${{ github.ref_name }} \
            --outdir outputs/index \
            --docs docs/CONTENT_INDEX.md
      - name: Commit docs
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "chore(docs): update CONTENT_INDEX.md (automated)"
          file_pattern: docs/CONTENT_INDEX.md
      - name: Upload artifact
        uses: actions/upload-artifact@v4
        with:
          name: repo-index
          path: |
            outputs/index/repo_index.json
```

### `.github/workflows/content_mirror.yml`

```text
name: Content Mirror
on:
  workflow_dispatch:
  schedule:
    - cron: "50 6 * * *"
jobs:
  mirror:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: "3.11"
      - run: |
          python -m pip install --upgrade pip
          pip install requests
      - name: Mirror textual files
        run: |
          python etf-trading-engine/scripts/fetch_file.py \
            --repo ${{ github.repository }} \
            --ref ${{ github.ref_name }} \
            --patterns "**/*.md,**/*.yml,**/*.yaml,**/*.csv,**/*.json,**/*.py" \
            --outdir outputs/mirror
      - name: Upload mirror artifact
        uses: actions/upload-artifact@v4
        with:
          name: repo-mirror
          path: outputs/mirror
```

### `.github/workflows/dataset.yml`

```text
name: EOD Dataset Publisher

on:
  workflow_dispatch: {}
  schedule:
    - cron: "15 4 * * *"  # 06:15 Europe/Rome

jobs:
  build-and-publish:
    runs-on: ubuntu-latest
    env:
      PYTHONPATH: etf-trading-engine
    steps:
      - name: Checkout trading-suite
        uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: Install deps
        run: |
          python -m pip install --upgrade pip
          pip install -r etf-trading-engine/requirements.txt

      - name: Download EOD (Web)
        run: |
          python etf-trading-engine/scripts/download_eod_yf.py             --universe ./etf-trading-config/universe.csv             --output ./etf-trading-engine/data/eod.csv             --start 2018-01-01             --threads 4             --sleep 0.25             --adjusted

      - name: Sanity check
        run: |
          python etf-trading-engine/scripts/sanity_check.py             --data ./etf-trading-engine/data/eod.csv             --min_rows 1000 --max_dd_allowed_pct 90

      - name: Build dataset (CSV+Parquet)
        run: |
          python etf-trading-engine/scripts/publish_dataset.py             --input ./etf-trading-engine/data/eod.csv             --outdir ./dataset

      - name: Upload dataset artifacts
        uses: actions/upload-artifact@v4
```

### `.github/workflows/remove_legacy_eod.yml`

```text
name: Cleanup — Remove legacy EOD publisher
on:
  workflow_dispatch:

permissions:
  contents: write

jobs:
  cleanup:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Remove legacy EOD workflows and self-delete
        run: |
          set -e
          git config user.name "ci-bot"
          git config user.email "ci-bot@users.noreply.github.com"

          removed=0
          for f in             ".github/workflows/build-and-publish.yml"             ".github/workflows/build-and-publish.yaml"             ".github/workflows/eod_dataset_publisher.yml"             ".github/workflows/eod_dataset_publisher.yaml"             ".github/workflows/eod_publisher.yml"             ".github/workflows/eod_publisher.yaml"             .github/workflows/EOD*.yml             .github/workflows/EOD*.yaml
          do
            if [ -f "$f" ]; then
              echo "Removing $f"
              git rm -f "$f" || true
              removed=1
            fi
          done

          # remove this cleanup workflow as well
          if [ -f ".github/workflows/remove_legacy_eod.yml" ]; then
            echo "Removing self workflow"
            git rm -f ".github/workflows/remove_legacy_eod.yml" || true
          fi

          if [ "$removed" -eq 1 ]; then
            git commit -m "chore: remove legacy EOD publisher workflows"
            git push origin HEAD:main
            echo "Legacy workflows removed and changes pushed."
```

### `.github/workflows/retro_asof.yml`

```text
name: Retro Run — As-Of

on:
  workflow_dispatch:
    inputs:
      as_of:
        description: "Data limite (YYYY-MM-DD)"
        required: true
        type: string
      start:
        description: "Data di inizio (opzionale, YYYY-MM-DD)"
        required: false
        type: string

concurrency:
  group: retro-asof-${{ github.ref }}
  cancel-in-progress: false

permissions:
  contents: read

jobs:
  retro:
    runs-on: ubuntu-22.04
    timeout-minutes: 60

    steps:
      - name: Checkout suite
        uses: actions/checkout@v4

      - name: Checkout datalake (read-only)
        uses: actions/checkout@v4
        with:
          repository: antoniosanso/etf-datalake
          path: etf-datalake
          fetch-depth: 1

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
```

### `.github/workflows/snapshot_workflows.yml`

```text
name: Snapshot Workflows
on:
  workflow_dispatch: {}
jobs:
  snapshot:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          persist-credentials: true
      - name: Snapshot workflow files
        run: |
          mkdir -p workflows_snapshot
          cp -R .github/workflows/*.yml workflows_snapshot/ || true
          cp -R .github/workflows/*.yaml workflows_snapshot/ || true
          echo "### Consolidated workflows snapshot" > workflows_snapshot/CONSOLIDATED.md
          for f in .github/workflows/*.yml .github/workflows/*.yaml; do
            [ -f "$f" ] || continue
            echo -e "\n\n## $f\n\n\`\`\`yaml" >> workflows_snapshot/CONSOLIDATED.md
            cat "$f" >> workflows_snapshot/CONSOLIDATED.md
            echo -e "\n\`\`\`" >> workflows_snapshot/CONSOLIDATED.md
          done
          git config user.name "github-actions"
          git config user.email "github-actions@github.com"
          git add workflows_snapshot
          git commit -m "Snapshot workflows"
          git push
```

### `.github/workflows/status_poster.yml`

```text
name: Public Status Poster
on:
  workflow_dispatch:
  schedule:
    - cron: "30 6 * * *"
permissions:
  contents: read
  issues: write
jobs:
  build-status:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: "3.11"
      - run: |
          python -m pip install --upgrade pip
          pip install requests
      - name: Universe snapshot
        run: |
          python etf-trading-engine/scripts/fetch_universe.py \
            --repo antoniosanso/etf-trading-suite \
            --path etf-trading-config/universe.csv \
            --outdir outputs/universe
      - name: KPI aggregator (best-effort)
        run: |
          python etf-trading-engine/scripts/kpi_aggregator.py \
            --backtest outputs/backtest/kpis.json \
            --wf outputs/wf/wf_report.json \
            --out outputs/status_kpi.json || true
      - name: Compose status.json
        run: |
          python etf-trading-engine/scripts/generate_status.py \
            --universe-json outputs/universe/universe_snapshot.json \
            --kpi-json outputs/status_kpi.json \
            --out outputs/status.json
      - name: Upload status artifact
        uses: actions/upload-artifact@v4
        with:
```

### `.github/workflows/trading_suite.yml`

```text
name: Trading Suite — Unified Daily
on:
  workflow_dispatch:
  schedule:
    - cron: '15 16 * * *'   # 18:15 Europe/Rome (CEST)
    - cron: '15 17 * * *'   # 18:15 Europe/Rome (CET)

permissions:
  contents: write

jobs:
  unified:
    runs-on: ubuntu-latest
    env:
      PYTHONPATH: etf-trading-engine

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Gate 18:15 Europe/Rome
        run: |
          if [ "${{ github.event_name }}" = "schedule" ]; then
            H=$(TZ=Europe/Rome date +%H:%M)
            if [ "$H" != "18:15" ]; then
              echo "Not 18:15; skipping"; exit 0
            fi
          fi
        shell: bash

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: Install deps
        run: |
          python -m pip install --upgrade pip
          pip install -r etf-trading-engine/requirements.txt
          pip install yfinance feedparser beautifulsoup4 requests vaderSentiment pandas numpy pyyaml
```

### `.github/workflows/unified.yml`

```text
name: Trading Suite — Unified Daily
on:
  workflow_dispatch: {}
  schedule:
    - cron: "15 16 * * *"
jobs:
  unified:
    runs-on: ubuntu-latest
    env:
      PYTHONPATH: etf-trading-engine
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: "3.11"
      - name: Install deps
        run: python -m pip install -r etf-trading-engine/requirements.txt
      - name: Download EOD
        run: |
          python etf-trading-engine/scripts/download_eod_yf.py             --universe ./etf-trading-config/universe.csv             --output ./etf-trading-engine/data/eod.csv             --start 2018-01-01             --threads 1             --sleep 1             --min_success 1
```

### `.github/workflows/universe_fetch.yml`

```text
name: Universe Snapshot
on:
  workflow_dispatch:
  schedule:
    - cron: "20 6 * * *"
jobs:
  fetch-universe:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: "3.11"
      - run: |
          python -m pip install --upgrade pip
          pip install requests
      - name: Fetch & validate universe
        run: |
          python etf-trading-engine/scripts/fetch_universe.py \
            --repo antoniosanso/etf-trading-suite \
            --path etf-trading-config/universe.csv \
            --outdir outputs/universe
      - name: Upload artifact
        uses: actions/upload-artifact@v4
        with:
          name: universe-snapshot
          path: |
            outputs/universe/universe_snapshot.csv
            outputs/universe/universe_snapshot.json
```

### `CLEANUP.md`
# Pulizia workflows

```text
# Pulizia workflows
Nel repo tieni **solo** questo file:
- .github/workflows/trading_suite.yml

Cancella eventuali altri file in `.github/workflows/`, ad es.:
- backtest.yml / backtest_ci.yml / backtest_fix.yml
- ci_eod.yml / eod_publisher.yml
- qualunque altro .yml diverso da trading_suite.yml
```

### `DECISIONS.md`
# DECISIONS.md

```text
# DECISIONS.md

- **[2025-10-08] Ingestion web (Yahoo)**; normalizzazione date tz-naive; dedup `(Ticker,Date)`.
- **[2025-10-08] Guardrails “rigidi + YELLOW”**; soglie invariate, borderline/NaN ⇒ YELLOW.
- **[2025-10-08] WF annuale + trimmed CoV** (`wf_trim:1`, soglia 30%).
- **[2025-10-08] Signals & Operational report** (breakout 52w, SL −7%, TP +14%, p=45%); LT SWDA/TNOW.
- **[2025-10-08] Pubblicazione dataset nel datalake** → cartella `latest/` su https://github.com/antoniosanso/etf-datalake.
```

### `PATCH_NOTES.md`

```text
PATCH: Rimozione completa del workflow legacy 'EOD Dataset Publisher'
Data: 20251009_125441 UTC

Cosa fa questo patch
- Aggiunge un workflow 'Cleanup — Remove legacy EOD publisher' che, quando lanciato, elimina
  i file workflow legacy dal repo **e poi si auto-elimina**.

Istruzioni
1) Carica nel repo `etf-trading-suite` il file `.github/workflows/remove_legacy_eod.yml` contenuto in questo zip (Upload files → Commit directly to main).
2) Vai su **Actions → Cleanup — Remove legacy EOD publisher → Run workflow**.
3) Al termine, il job rimuoverà:
   - `.github/workflows/build-and-publish.yml` (e varianti), ed eventuali alias tipo `eod_publisher*.yml`
   - **e si rimuoverà anche da solo** (`remove_legacy_eod.yml`).
4) Verifica in **Code → .github/workflows/** che restino solo i workflow che vuoi tenere
   (es: *Trading Suite — Unified Daily*).

Note
- Il branch di default usato è `main`. Se il repo usa un altro branch predefinito, dimmelo e preparo una versione ad hoc.
```

### `README.md`
# ETF Trading Suite (v4.1)
## Come pubblicare su GitHub (Windows, 2 minuti)
## Esecuzione locale (facoltativa)
# merge CSV dal datalake locale (cartella sorella etf-datalake)
# backtest locale

```text
# ETF Trading Suite (v4.1)

Suite pronta per GitHub con:
- **Engine** (motore di backtest)
- **Config** (parametri, universo, schedule)
- **CI** (GitHub Actions: merge dati → backtest → artifact KPI)

Datalake usato in read‑only: `antoniosanso/etf-datalake`

## Come pubblicare su GitHub (Windows, 2 minuti)
1) Apri **Prompt dei comandi** nella cartella di questa suite.
2) Copia e incolla, **una riga alla volta**:
```
git init
git add .
git commit -m "init suite v4.1 (engine+config+CI)"
git branch -M main
git remote add origin https://github.com/antoniosanso/etf-trading-suite.git
git push -u origin main
```
3) Su GitHub → tab **Actions** → workflow “Backtest (CI)”.  
   Al termine scarica l’artifact **backtest-artifacts** (KPIs + equity curve).

## Esecuzione locale (facoltativa)
```
cd etf-trading-engine
python -m venv .venv
.venv\Scripts\activate
pip install --upgrade pip
pip install -r requirements.txt

# merge CSV dal datalake locale (cartella sorella etf-datalake)
python scripts\merge_eod.py --datalake ..\etf-datalake --output data\eod.csv --recursive --datecol dt --closecol close --tickercol ticker --opencol open --highcol high --lowcol low --volumecol volume

# backtest locale
python examples\run_backtest.py --config ..\etf-trading-config\model.yaml --data data\eod.csv
```

> Nota: se il datalake GitHub è **privato**, il workflow richiederà PAT/token. Se è pubblico, parte subito.
```

### `README_DATASET.txt`

```text
EOD Dataset Publisher & Portfolio Tools
--------------------------------------
- Aggiunge un workflow 'EOD Dataset Publisher' che, ogni giorno alle 06:15 Europe/Rome, scarica i prezzi via web per tutti i ticker di `etf-trading-config/universe.csv`, valida e pubblica gli artifact:
  - dataset/eod-latest.csv
  - dataset/eod-latest.parquet
  - dataset/by_ticker/*.csv
  - dataset/summary.json
- Include strumenti semplici per analisi di portafoglio: `portfolio_tools.py` e `examples/portfolio_cli.py`.
```

### `README_MULTILAYER_BACKTEST.md`
# Multilayer Backtest Bundle (TNOW.MI & XAIX.MI)

```text
# Multilayer Backtest Bundle (TNOW.MI & XAIX.MI)

**Esperimenti**: S0 BuyHold, S1 Breakout, S2 Multilayer, S3 Breakout+Checklist.
**Proxy** inclusi: SWDA.MI (mercato), IXN (settore IT), QQQ (breadth/growth).

**Uso**: copia nella root del repo, commit, poi esegui Actions → Backtest (Matrix) via Web Ingest.
Al termine, scarica gli artifact `kpis-<RUN_ID>` e confronta le metriche.

Parametri chiave e checklist sono in `etf-trading-config/model.yaml`.
```

### `README_OPS.md`
# ETF Trading Suite — README_OPS
## Repos
## Architettura
## Workflow principali
## Guardrails (rigidi + YELLOW per borderline)
## File chiave

```text
# ETF Trading Suite — README_OPS

**Obiettivo:** ingest web, backtest+WF, guardrail, **segnali operativi** e **report operativo** giornaliero.

## Repos
- **Trading Suite**: https://github.com/antoniosanso/etf-trading-suite
- **Datalake (dataset pubblicati)**: https://github.com/antoniosanso/etf-datalake

## Architettura
- **Ingestion Web** (Yahoo Finance) → `etf-trading-engine/scripts/download_eod_yf.py` → `etf-trading-engine/data/eod.csv`
- **Dataset Publisher** → artifact + pubblicazione su **datalake/latest/** (`eod-latest.csv`, `.parquet`, `summary.json`)
- **Backtest (CI)** → sanity → backtest → walk-forward → guardrails → artifact KPI
- **Signals** → `outputs/signals/{entries_today.csv,watchlist_today.csv,summary.md}`
- **Operational report** → `outputs/operational_report.md` (tabella operativa)

## Workflow principali
- `Backtest (CI via Web Ingest)` (cron: ~06:00 CET)
- `EOD Dataset Publisher` (cron: ~06:15 CET) → **pubblica nel datalake**

## Guardrails (rigidi + YELLOW per borderline)
- Sharpe ≥ 0.30 · ProfitFactor ≥ 1.10 · |MaxDD| ≤ 35% · WF Calmar CoV ≤ 30% (trimmed, `wf_trim:1`)
- Borderline (±10%) o WF incompleto ⇒ **YELLOW**; violazione netta ⇒ **RED**.

## File chiave
`etf-trading-config/model.yaml`, `signals.yaml`, `operational.yaml`, `wf_windows.yaml`

> Questo documento va tenuto **alla radice** del repo *trading-suite* e allegato al Project “Investimenti”.
```

### `README_PUBLISH_TO_DATALAKE.txt`

```text
# Istruzioni per la pubblicazione nel datalake

1) Su https://github.com/antoniosanso/etf-trading-suite vai su **Settings → Secrets and variables → Actions** → **New repository secret**  
   - Name: `DATASINK_TOKEN`  
   - Value: *Personal Access Token* (scope **repo**) del tuo account

2) Verifica che https://github.com/antoniosanso/etf-datalake abbia branch `main` e che tu abbia permessi di push.

3) Carica questo workflow (`.github/workflows/dataset.yml`) nel repo *trading-suite* e lancialo da **Actions**.

Il job copierà ogni mattina i file in `etf-datalake/latest/`:
- `eod-latest.csv`
- `eod-latest.parquet` (se disponibile)
- `summary.json`
- CSV per-ticker nella cartella `by_ticker/` (solo come artifact, non nel datalake per evitare gonfiaggio del repo).
```

### `README_RETRO_ASOF.txt`

```text
# Retro Run — As Of (Add-on)

Questo pacchetto aggiunge un workflow manuale per eseguire simulazioni "retroattive" al motore ETF Trading Suite.

## Istruzioni
1. Carica il contenuto dello zip nella root del repository principale.
2. Conferma il commit su `main`.
3. Vai su **Actions → Retro Run — As-Of → Run workflow**.
4. Imposta `as_of` (es. `2024-04-15`) e lascia `start` vuoto.
5. I risultati appariranno tra gli artifact con nome `retro-asof-YYYY-MM-DD`.
```

### `README_WEB_INGEST.txt`

```text
Web Ingest Upgrade
------------------
Questo pacchetto sostituisce il datalake con un download diretto da Yahoo Finance.
Carica i file mantenendo la stessa struttura (sovrascrivi .github/workflows/backtest.yml e aggiungi scripts/download_eod_yf.py).

Il workflow userà i ticker presenti in etf-trading-config/universe.csv.
Per espandere l'universo, aggiungi righe a universe.csv (colonna 'Ticker') e fai Commit: il CI scaricherà i nuovi dati automaticamente.
```

### `RUNBOOK.md`
# RUNBOOK.md
## Aggiornare l’universo
## Lanciare i workflow
## Leggere i risultati
## Pubblicazione nel datalake

```text
# RUNBOOK.md

## Aggiornare l’universo
- Edit `etf-trading-config/universe.csv` → commit → la prossima run scarica i nuovi ticker.

## Lanciare i workflow
- Actions → **Backtest (CI via Web Ingest)** → Run workflow
- Actions → **EOD Dataset Publisher** → Run workflow

## Leggere i risultati
- KPI: artifact `backtest-artifacts`
- WF: `wf_report.json`, `wf_summary.txt`
- Signals: artifact `signals`
- Report operativo: artifact `operational-report`
- Dataset: artifact `eod-dataset` **e** nel repo **datalake/latest/**

## Pubblicazione nel datalake
Richiede secret `DATASINK_TOKEN` (PAT con scope `repo`) nel repo *trading-suite*.
```

### `docs/CONTENT_INDEX.md`
# Repository Content Index — antoniosanso/etf-trading-suite@main
## Estratti e Headings
### `.github/workflows/backtest_matrix.yml`
### `.github/workflows/content_index.yml`
### `.github/workflows/content_mirror.yml`
### `.github/workflows/dataset.yml`
### `.github/workflows/remove_legacy_eod.yml`
### `.github/workflows/retro_asof.yml`
### `.github/workflows/snapshot_workflows.yml`
### `.github/workflows/status_poster.yml`
### `.github/workflows/trading_suite.yml`
### `.github/workflows/unified.yml`
### `.github/workflows/universe_fetch.yml`
### `CLEANUP.md`
# Pulizia workflows
# Pulizia workflows
### `DECISIONS.md`
# DECISIONS.md
# DECISIONS.md
### `PATCH_NOTES.md`

```text
# Repository Content Index — antoniosanso/etf-trading-suite@main

Questa pagina è generata automaticamente dal workflow **Content Indexer**.

| Path | Size | SHA (short) | Link | Raw |
|---|---:|---|---|---|

| `.github/workflows/backtest_matrix.yml` | 3,135 | `06ce210c` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/.github/workflows/backtest_matrix.yml) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/.github/workflows/backtest_matrix.yml) |
| `.github/workflows/content_index.yml` | 1,451 | `e65d17be` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/.github/workflows/content_index.yml) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/.github/workflows/content_index.yml) |
| `.github/workflows/content_mirror.yml` | 815 | `7d9497a7` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/.github/workflows/content_mirror.yml) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/.github/workflows/content_mirror.yml) |
| `.github/workflows/dataset.yml` | 2,538 | `6f505c82` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/.github/workflows/dataset.yml) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/.github/workflows/dataset.yml) |
| `.github/workflows/remove_legacy_eod.yml` | 1,584 | `30c0939d` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/.github/workflows/remove_legacy_eod.yml) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/.github/workflows/remove_legacy_eod.yml) |
| `.github/workflows/retro_asof.yml` | 3,438 | `9edaf0a2` | [blob](https://github.com/antoniosanso/etf-trading-suite/blob/main/.github/workflows/retro_asof.yml) | [raw](https://raw.githubusercontent.com/antoniosanso/etf-trading-suite/refs/heads/main/.github/workflows/retro_asof.yml) |
| `.github/workflows/snapshot
```

### `docs/UNIFIED_AUTOMATION_PATCH.md`
# ETF Trading Suite — Unified Automation Patch
## Workflows inclusi
## Script inclusi
## Setup rapido
## Estensioni (facoltative)

```text
# ETF Trading Suite — Unified Automation Patch

Questa patch unifica e amplia tutte le capacità richieste:
- **Universe Snapshot**: conteggio titoli, duplicati, lista normalizzata (artifact JSON/CSV).
- **Public Status Poster**: Issue pubblica con ancora univoca + KPI integrati (se presenti).
- **Content Indexer**: indice completo del repo, sommari file chiave, pubblicazione su GitHub Pages.
- **Content Mirror**: mirror selettivo di file testuali come artifact per consumo esterno.
- **Generic Fetcher**: scarica pattern arbitrari di file dal repo in `outputs/mirror`.

## Workflows inclusi
- `.github/workflows/universe_fetch.yml`
- `.github/workflows/status_poster.yml`
- `.github/workflows/content_index.yml`
- `.github/workflows/content_mirror.yml`

## Script inclusi
- `etf-trading-engine/scripts/fetch_universe.py`
- `etf-trading-engine/scripts/generate_status.py`
- `etf-trading-engine/scripts/kpi_aggregator.py`
- `etf-trading-engine/scripts/index_repo.py`
- `etf-trading-engine/scripts/fetch_file.py`

## Setup rapido
1. Unzip nella root del repo mantenendo i percorsi.
2. (Se non già fatto) abilita **GitHub Pages** → “Build and deployment: GitHub Actions”.
3. Esegui manualmente:
   - **Universe Snapshot**
   - **Public Status Poster**
   - **Content Indexer**
   - **Content Mirror**

Dopo il primo run:
- Troverai una Issue “**ETF-TRADING-SUITE PUBLIC STATUS ANCHOR 9E1F2C — Live Status**” con:
  - numero di **ticker unici**, duplicati
  - KPI (Sharpe, PF, MaxDD, WF Calmar CoV) se disponibili
- `docs/CONTENT_INDEX.md` mostrerà **tutti i file** con link blob/raw e excerpt.
- Gli artifact `repo-index`, `repo-mirror`, `public-status`, `universe-snapshot` saranno disponibili per download.

## Estensioni (facoltative)
- Agganciare i workflow di backtest per scrivere KPI in `outputs/backtest/kpis.json` e `outputs/wf/wf_report.json` così lo **Status Poster** mostra sempre i numeri aggiornati.
```

### `docs/UNIVERSE_PIPELINE.md`
# Universe Pipeline
## File
## Come funziona
## Perché è utile
## Estensioni suggerite

```text
# Universe Pipeline

Questa pipeline aggiunge un job autonomo per **scaricare e validare** `etf-trading-config/universe.csv` e pubblicare uno **snapshot** come artifact.

## File
- `etf-trading-engine/scripts/fetch_universe.py`
- `.github/workflows/universe_fetch.yml`

## Come funziona
1. Esegue lo script in Python (richiede `requests`).
2. Stampa un **riepilogo** in log (righe totali, unici, duplicati, sample).
3. Carica come artifact:
   - `outputs/universe/universe_snapshot.csv`
   - `outputs/universe/universe_snapshot.json` (contiene anche la lista dei ticker).

## Perché è utile
- Consente ad altri workflow (e a te) di consumare uno **snapshot normalizzato** senza aprire il file raw.
- È un punto unico per rilevare **duplicati** o righe non valide.

## Estensioni suggerite
- Aggiungere una dipendenza dei workflow di backtest in modo che raccolgano questo artifact prima di girare.
- Fail-fast se `duplicate_rows > 0` (basta fare `jq` sulla chiave e exit 1).
```

### `etf-trading-config/README.md`
# etf-trading-config

```text
# etf-trading-config
Parametri modello v4.1.
```

### `etf-trading-config/features.yaml`

```text
sentiment:
  enabled: true
  source: multi
  lookback_days: 3
  weight: 0.15
  smoothing_days: 3
  min_articles: 5
  topic_mapping_csv: etf-trading-config/mappings/etf_topics.csv
regime:
  enabled: true
  weight: 0.20
  vix_symbol: ^VIX
  credit_risk_ratio: [HYG, IEF]
  smoothing_days: 5
fundamentals:
  enabled: true
  weight: 0.10
  max_holdings: 15
  yf_timeout: 20
```

### `etf-trading-config/mappings/etf_topics.csv`

```text
ETF,Topic
SPY,usa_equities
QQQ,tech_equities
```

### `etf-trading-config/mappings/yf_overrides.csv`

```text
Ticker,YF
IUSN.L,IS3N.L
CSPX.L,CSPX.L
VUAA.L,VUAA.L
VUSA.L,VUSA.L
```

### `etf-trading-config/model.stopcriteria.patch.yaml`

```text
stop_criteria:
  min_sharpe: 0.25
  profit_factor_min: 1.05
  maxdd_limit_pct: 0.35
  wf_calmar_var_max_pct: 40.0
  wf_trim: 1
```

### `etf-trading-config/model.yaml`

```text
params:
  atr_pct: 1.0
  buffer_mul: 1.0
  buffer_mult: 1.0
  vol_z_min: -3.0
  vol_z_max: 3.0

general:
  data:
    source: "web_yahoo"
    adjusted: true
    start: "2018-01-01"
    tz_utc: true
  risk:
    default_risk_per_trade_pct: 1.5
  walk_forward:
    windows_yaml: "etf-trading-config/wf_windows.yaml"
    trimmed_cov_ignore_extremes: 1
    cov_threshold_pct: 30.0

runs:

  S0_buyhold:
    description: "Buy & Hold con trailing ampio (core)"
    universe: "etf-trading-config/universe.csv"
    entry: {mode: "market_open_next"}
    exit:
      trailing_pct_by_ticker: {TNOW.MI: 12.0, XAIX.MI: 15.0, default: 12.0}
    stop_loss: null
    take_profit: null
    guardrails: {sharpe_min: -999.0, profit_factor_min: 0.0, maxdd_abs_max_pct: 100.0, wf_calmar_cov_max_pct: 100.0}

  S1_breakout:
    description: "Breakout 52w +0,3% con SL -7% e TP +14%"
    universe: "etf-trading-config/universe.csv"
    entry: {mode: "breakout_52w", buffer_pct: 0.3}
    stop_loss: {mode: "percent", value_pct: 7.0}
    take_profit: {mode: "percent", value_pct: 14.0}
    exit: {break_even_after_tp1: false}
```

### `etf-trading-config/news_sources.yaml`

```text
rss:
  - https://feeds.a.dj.com/rss/RSSMarketsMain.xml
  - https://www.reutersagency.com/feed/?best-topics=markets&post_type=best
  - https://feeds.finance.yahoo.com/rss/2.0/headline?s=SPY&region=US&lang=en-US
  - https://feeds.finance.yahoo.com/rss/2.0/headline?s=QQQ&region=US&lang=en-US
  - https://www.etftrends.com/feed/
  - https://www.etf.com/feeds/all
  - https://seekingalpha.com/market_currents.xml
google_news_queries:
  - "site:ishares.com ETF"
  - "site:vanguard.com ETF"
  - "site:amundietf.com ETF"
  - "SPY ETF"
  - "QQQ ETF"
  - "MSCI World ETF UCITS"
  - "S&P 500 ETF UCITS"
gdelt_enabled: true
gdelt_topics:
  - "technology sector"
  - "energy sector"
  - "semiconductors"
  - "emerging markets"
  - "developed markets"
```

### `etf-trading-config/operational.yaml`

```text
trading:
  capital_eur: 10000
  lines: 3
  breakout_margin_pct: 0.3
  sl_pct: 7
  tp_pct: 14
  p_win: 0.45
  horizon: "20–60 gg"
  prefer_signals: true
  tickers_override: []
long_term:
  capital_eur: 30000
  holdings:
    - { ticker: "SWDA.MI", weight_pct: 60, trail_stop_pct: 12, exp_12m_return_pct: 11 }
    - { ticker: "TNOW.MI", weight_pct: 40, trail_stop_pct: 18, exp_12m_return_pct: 14 }
```

### `etf-trading-config/schedules.md`
## Walk-Forward 2020–2025

```text
## Walk-Forward 2020–2025
- WF-1: Train 2020-01-01 → 2021-12-31 | Test 2022-01-01 → 2022-06-30
- WF-2: Train 2020-07-01 → 2022-06-30 | Test 2022-07-01 → 2022-12-31
- WF-3: Train 2021-01-01 → 2022-12-31 | Test 2023-01-01 → 2023-06-30
- WF-4: Train 2021-07-01 → 2023-06-30 | Test 2023-07-01 → 2023-12-31
- WF-5: Train 2022-01-01 → 2023-12-31 | Test 2024-01-01 → 2024-06-30
- WF-6: Train 2022-07-01 → 2024-06-30 | Test 2024-07-01 → 2024-12-31
- WF-7: Train 2023-01-01 → 2024-12-31 | Test 2025-01-01 → 2025-06-30
- WF-8: Train 2023-07-01 → 2025-06-30 | Test 2025-07-01 → 2025-10-08
```

### `etf-trading-config/signals.yaml`

```text
# Signals config — complete defaults incl. rank weights (mom252 + mom63)
strategy: "sma_crossover"

# SMA
sma_fast: 20
sma_slow: 50
min_periods: 20

# ATR
atr_period: 14

# Breakout / Donchian
breakout_lookback: 260
breakout_buffer_pct: 0.3

# Liquidity filters
min_adv20: 0
min_volume: 0

# Momentum ranking weights
# Alcuni script usano 'mom63' (6-3 mesi) invece di 'mom6': forniamo entrambe
rank_weights:
  mom252: 0.6
  mom63: 0.4
  mom6: 0.0

risk_per_trade_pct: 1.0
output_dir: "./outputs/signals"
```

### `etf-trading-config/signals.yaml.append`

```text
# Add safe default for top_n to avoid KeyError after RankScore fix
top_n: 10
```

### `etf-trading-config/universe.csv`

```text
Ticker
TNOW.MI
XAIX.MI
```

### `etf-trading-config/wf_windows.yaml`

```text
windows:
  - name: "WF_2019"
    test_start: "2019-01-01"
    test_end:   "2019-12-31"

  - name: "WF_2020"
    test_start: "2020-01-01"
    test_end:   "2020-12-31"

  - name: "WF_2021"
    test_start: "2021-01-01"
    test_end:   "2021-12-31"

  - name: "WF_2022"
    test_start: "2022-01-01"
    test_end:   "2022-12-31"

  - name: "WF_2023"
    test_start: "2023-01-01"
    test_end:   "2023-12-31"

  - name: "WF_2024"
    test_start: "2024-01-01"
    test_end:   "2024-12-31"

  - name: "WF_2025"
    test_start: "2025-01-01"
    test_end:   "2025-12-31"

trim_extremes: 1
cov_threshold_pct: 30.0
```

### `etf-trading-engine/README.md`
# etf-trading-engine

```text
# etf-trading-engine
Motore di backtest per ETF UCITS (v4.1).
```

### `etf-trading-engine/examples/portfolio_cli.py`

```text
import argparse, json
from pathlib import Path
import pandas as pd
from portfolio_tools import load_dataset, pivot_close, daily_returns, build_portfolio, kpis, corr_matrix

def main():
    ap = argparse.ArgumentParser()
    ap.add_argument('--dataset', required=True, help='Path to eod-latest.csv')
    ap.add_argument('--weights', help='JSON mapping ticker->weight (e.g. {"SEME":0.25,...})')
    ap.add_argument('--corr', action='store_true', help='Print correlation matrix')
    args = ap.parse_args()

    df = load_dataset(args.dataset)
    px = pivot_close(df)
    rets = daily_returns(px)

    if args.weights:
        w = json.loads(args.weights)
        port = build_portfolio(rets, w)
        kp = kpis(port)
        print("PORTFOLIO KPIs", kp)

    if args.corr:
        print(corr_matrix(rets))

if __name__ == '__main__':
    main()
```

### `etf-trading-engine/examples/run_backtest.py`

```text
import argparse, yaml, pandas as pd, sys, os
repo_root = os.path.abspath(os.path.join(os.path.dirname(__file__), '..'))
if repo_root not in sys.path:
    sys.path.insert(0, repo_root)

from src.engine.backtest import run_backtest

ap = argparse.ArgumentParser()
ap.add_argument('--config', required=True, help='Path to model.yaml')
ap.add_argument('--data', default='data/eod.csv', help='Path to merged EOD CSV')
args = ap.parse_args()

with open(args.config, 'r', encoding='utf-8') as f:
    cfg = yaml.safe_load(f)

prices = pd.read_csv(args.data)
prices['Date'] = pd.to_datetime(prices['Date'])

result = run_backtest(prices, cfg)
print(result['kpis'])
```

### `etf-trading-engine/requirements.txt`

```text
pandas>=2.2.0
numpy>=1.26.0
scipy>=1.11.0
statsmodels>=0.14.2
pyyaml>=6.0.1
requests>=2.32.0
yfinance>=0.2.40
```

### `etf-trading-engine/scripts/aggregate_fundamentals.py`

```text
import argparse, pandas as pd, numpy as np
from pathlib import Path
def fetch_top_holdings(etf, max_n=15):
    try:
        import yfinance as yf
        t = yf.Ticker(etf)
        holds = []
        if hasattr(t, 'fund_holdings') and isinstance(t.fund_holdings, dict) and 'holdings' in t.fund_holdings:
            for row in t.fund_holdings['holdings'][:max_n]:
                holds.append((row.get('symbol') or row.get('ticker') or '', float(row.get('holdingPercent',0.0))))
        elif hasattr(t, 'holdings') and isinstance(t.holdings, list):
            for row in t.holdings[:max_n]:
                sym = row.get('symbol') or row.get('ticker') or ''
                wgt = float(row.get('holdingPercent',0.0) or row.get('weight',0.0))
                holds.append((sym, wgt))
        out = []
        for s,w in holds:
            s = (s or '').upper().strip()
            if s and w>0: out.append((s,w))
        return out[:max_n]
    except Exception:
        return []
def fetch_fundamentals(tickers):
    try:
        import yfinance as yf
    except Exception:
        return {}
    vals = {}
    for s in tickers:
        try:
            tk = yf.Ticker(s)
            info = {}
            try: info = tk.info or {}
            except: info = {}
            rev = float(info.get('revenueGrowth', 0.0) or 0.0)
            margin = float(info.get('operatingMargins', 0.0) or 0.0)
            vals[s] = (rev, margin)
        except Exception:
            continue
    if not vals: return {}
```

### `etf-trading-engine/scripts/aggregate_news.py`

```text
import argparse, yaml, pandas as pd, numpy as np, re, os
from pathlib import Path
def try_imports():
    import importlib; mods = {}
    for m in ["feedparser", "requests", "vaderSentiment.vaderSentiment"]:
        try: mods[m] = importlib.import_module(m)
        except Exception: mods[m] = None
    return mods
MODS = try_imports()
feedparser = MODS.get("feedparser"); requests = MODS.get("requests")
vader_mod = MODS.get("vaderSentiment.vaderSentiment")
SentimentIntensityAnalyzer = getattr(vader_mod, "SentimentIntensityAnalyzer", None) if vader_mod else None
def clean(x): return re.sub(r"\s+"," ",x).strip() if isinstance(x,str) else ""
def fetch_rss(url, k=50):
    if not feedparser: return []
    try:
        fp = feedparser.parse(url)
        return [{"source":"rss","url":url,"title":clean(e.get("title","")), "desc":clean(e.get("summary","") or e.get("description","")), "link":e.get("link","") } for e in fp.get("entries", [])[:k]]
    except Exception: return []
def fetch_google(q, k=20):
    if not feedparser: return []
    import urllib.parse as up
    url = f"https://news.google.com/rss/search?q={up.quote(q)}&hl=en-US&gl=US&ceid=US:en"
    try:
        fp = feedparser.parse(url)
        return [{"source":"google","url":url,"title":clean(e.get("title","")), "desc":clean(e.get("summary","")), "link":e.get("link","")} for e in fp.get("entries", [])[:k]]
    except Exception: return []
def fetch_gdelt(q, k=30):
    if not requests: return []
    try:
        r = requests.get("https://api.gdeltproject.org/api/v2/doc/doc", params={"query":q,"mode":"ArtList","format":"JSON","maxrecords":str(k*2)}, timeout=20)
        data = r.json(); items = []
        for d in data.get("articles", [])[:k]:
            items.append({"source":"gdelt","url":"gdelt","title":clean(d.get("title","")), "desc":clean(d.get("seendate","")), "link":d.get("url","")})
        return items
    except Exception: return []
def sentiment(txt):
    if not SentimentIntensityAnalyzer: return 0.0
    sid
```

### `etf-trading-engine/scripts/append_reports.py`

```text
#!/usr/bin/env python3
import json, datetime
from pathlib import Path

Path("reports/history").mkdir(parents=True, exist_ok=True)
Path("reports/daily").mkdir(parents=True, exist_ok=True)
ts = datetime.datetime.utcnow().isoformat()+"Z"

def loadj(p):
    try:
        return json.load(open(p,"r",encoding="utf-8"))
    except Exception:
        return {}

k = loadj("outputs/kpis.json")
wf = loadj("outputs/wf_report.json")
gr = loadj("outputs/guardrails_status.json")

# daily snapshot
today = datetime.date.today().isoformat()
Path(f"reports/daily/{today}").mkdir(parents=True, exist_ok=True)
for src in ("kpis.json","wf_report.json","guardrails_status.json"):
    try:
        Path(f"reports/daily/{today}/{src}").write_text(open(f"outputs/{src}",'r',encoding='utf-8').read(), encoding='utf-8')
    except Exception:
        pass

# jsonl histories
with open("reports/history/kpis.jsonl","a",encoding="utf-8") as f:
    f.write(json.dumps({"ts":ts,"kpis":k})+"\n")
with open("reports/history/wf.jsonl","a",encoding="utf-8") as f:
    f.write(json.dumps({"ts":ts,"wf":wf})+"\n")

# latest
json.dump({"ts":ts,"kpis":k,"wf":wf,"guardrails":gr}, open("reports/latest.json","w",encoding="utf-8"), indent=2)
print("[OK] reports updated")
```

### `etf-trading-engine/scripts/build_features.py`

```text
#!/usr/bin/env python3
import argparse, yaml, pandas as pd, numpy as np, sys
from pathlib import Path

def _fetch_series_yf(symbol: str, start: str, end: str):
    try:
        import yfinance as yf
    except Exception as e:
        print(f"[ERROR] yfinance non installato: {e}", file=sys.stderr)
        return pd.Series(dtype="float64")
    try:
        df = yf.download(symbol, start=start, end=end, interval="1d", auto_adjust=False, progress=False)
        if df is None or df.empty:
            t = yf.Ticker(symbol)
            df = t.history(start=start, end=end, interval="1d", auto_adjust=False)
        if df is None or df.empty:
            print(f"[WARN] Nessun dato per {symbol}", file=sys.stderr)
            return pd.Series(dtype="float64")
        df = df.copy()
        col = "Adj Close" if "Adj Close" in df.columns else ("Close" if "Close" in df.columns else None)
        if col is None:
            try:
                df.columns = [" ".join([c for c in c if isinstance(c, str)]) if isinstance(c, tuple) else c for c in df.columns]
                col = "Adj Close" if "Adj Close" in df.columns else ("Close" if "Close" in df.columns else None)
            except Exception:
                pass
        if col is None:
            print(f"[WARN] Colonna Close/Adj Close assente per {symbol}", file=sys.stderr)
            return pd.Series(dtype="float64")
        s = pd.to_numeric(df[col], errors="coerce")
        s.index = pd.to_datetime(df.index, utc=True).tz_localize(None)
        s.name = symbol
        return s.dropna()
    except Exception as e:
        print(f"[WARN] Errore fetch {symbol}: {e}", file=sys.stderr)
        return pd.Series(dtype="float64")

def build_regime(cfg: dict):
    start = str(cfg.get("start", "2018-01-01"))
    end = str(cfg.get("end", pd.Timestamp.today().date().isoformat()))
```

### `etf-trading-engine/scripts/clip_asof.py`

```text
import pandas as pd
import argparse

def main():
    parser = argparse.ArgumentParser(description="Clip EOD data up to an as-of date.")
    parser.add_argument("--input", required=True, help="Percorso del file di input (EOD completo).")
    parser.add_argument("--output", required=True, help="Percorso del file di output clippato.")
    parser.add_argument("--as-of", required=True, help="Data limite in formato YYYY-MM-DD.")
    parser.add_argument("--start", required=False, help="Data di inizio (opzionale).")
    args = parser.parse_args()

    df = pd.read_csv(args.input, parse_dates=["dt"])

    if args.start:
        df = df[(df["dt"] >= args.start) & (df["dt"] <= args.as_of)]
    else:
        df = df[df["dt"] <= args.as_of]

    df.to_csv(args.output, index=False)
    print(f"✅ Dati tagliati al {args.as_of} salvati in {args.output}")

if __name__ == "__main__":
    main()
```

### `etf-trading-engine/scripts/download_eod_yf.py`

```text
#!/usr/bin/env python3
import argparse, pandas as pd, datetime as dt, sys, time
from pathlib import Path

def fetch_history(sym, start, end):
    import yfinance as yf
    try:
        t = yf.Ticker(sym)
        df = t.history(start=start, end=end, interval="1d", auto_adjust=False)
        if df is None or df.empty:
            df = t.history(period="max", interval="1d", auto_adjust=False)
        if df is None or df.empty:
            return pd.DataFrame()
        df = df.reset_index().rename(columns={
            'Date':'Date','Open':'Open','High':'High','Low':'Low','Close':'Close','Volume':'Volume'
        })
        for c in ['Open','High','Low','Close','Volume']:
            if c in df.columns:
                df[c] = pd.to_numeric(df[c], errors='coerce')
        df['Date'] = pd.to_datetime(df['Date'], utc=True, errors='coerce').dt.tz_localize(None)
        return df[['Date','Open','High','Low','Close','Volume']]
    except Exception as e:
        print(f"[WARN] {sym}: {e}", file=sys.stderr)
        return pd.DataFrame()

def main():
    ap = argparse.ArgumentParser()
    ap.add_argument('--universe', required=True, help='CSV con colonne Ticker e opzionale YF')
    ap.add_argument('--output', required=True, help='File CSV di output')
    ap.add_argument('--start', default="2018-01-01")
    ap.add_argument('--end', default=None)
    ap.add_argument('--threads', type=int, default=4)
    ap.add_argument('--sleep', type=float, default=0.15)
    ap.add_argument('--min_success', type=int, default=5)
    args = ap.parse_args()

    uni = pd.read_csv(args.universe)
    if 'YF' in uni.columns:
        uni['Symbol'] = uni['YF'].fillna(uni['Ticker']).astype(str)
    else:
```

### `etf-trading-engine/scripts/fetch_file.py`

```text
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
fetch_file.py — Fetch arbitrary files from a repo (by path or glob) and mirror them into outputs/mirror.
"""
import os, sys, argparse, json, fnmatch, requests

def get_tree(owner: str, repo: str, ref: str, token: str|None):
    url = f"https://api.github.com/repos/{owner}/{repo}/git/trees/{ref}?recursive=1"
    headers = {"User-Agent": "file-fetcher/1.0"}
    if token:
        headers["Authorization"] = f"Bearer {token}"
    r = requests.get(url, headers=headers, timeout=60)
    r.raise_for_status()
    return r.json().get("tree", [])

def raw_url(owner: str, repo: str, ref: str, path: str):
    ref_part = f"refs/heads/{ref}" if len(ref) < 40 else ref
    return f"https://raw.githubusercontent.com/{owner}/{repo}/{ref_part}/{path}"

def fetch(url: str, token: str|None):
    headers = {"User-Agent": "file-fetcher/1.0"}
    if token:
        headers["Authorization"] = f"Bearer {token}"
    r = requests.get(url, headers=headers, timeout=60)
    return r.status_code, r.content

def main():
    ap = argparse.ArgumentParser()
    ap.add_argument("--repo", default="antoniosanso/etf-trading-suite")
    ap.add_argument("--ref", default="main")
    ap.add_argument("--patterns", default="**/*.md,**/*.yml,**/*.yaml,**/*.csv,**/*.json,**/*.py")
    ap.add_argument("--outdir", default="outputs/mirror")
    args = ap.parse_args()

    owner, repo = args.repo.split("/", 1)
    token = os.environ.get("GITHUB_TOKEN", "").strip() or None
    tree = get_tree(owner, repo, args.ref, token)
    pats = [p.strip() for p in args.patterns.split(",") if p.strip()]
```

### `etf-trading-engine/scripts/fetch_universe.py`

```text
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
fetch_universe.py — Fetch & validate the ETF universe from a public GitHub repo.
Outputs:
- outputs/universe/universe_snapshot.csv
- outputs/universe/universe_snapshot.json
"""
import os, sys, csv, json, argparse, requests
from typing import Optional, Tuple, List

def _build_raw_url(repo: str, path: str, ref: str = "refs/heads/main") -> str:
    return f"https://raw.githubusercontent.com/{repo}/{ref}/{path}"

def _fetch(url: str, token: Optional[str] = None) -> Tuple[int, bytes]:
    headers = {"User-Agent": "universe-fetcher/1.0"}
    if token:
        headers["Authorization"] = f"Bearer {token}"
    r = requests.get(url, headers=headers, timeout=30)
    return r.status_code, r.content

def get_universe_text(repo: Optional[str], path: Optional[str], ref: str, raw_url: Optional[str]) -> str:
    token = os.environ.get("GITHUB_TOKEN", "").strip() or None
    if raw_url:
        code, content = _fetch(raw_url, token)
        if code == 200:
            return content.decode("utf-8", errors="replace")
        raise RuntimeError(f"fetch failed {code} for raw={raw_url}")
    if not (repo and path):
        raise ValueError("Either --raw or both --repo and --path must be provided.")
    url = _build_raw_url(repo, path, ref)
    code, content = _fetch(url, token)
    if code == 200:
        return content.decode("utf-8", errors="replace")
    # Fallback: GitHub Contents API
    api_url = f"https://api.github.com/repos/{repo}/contents/{path}?ref={ref}"
    code, content = _fetch(api_url, token)
    if code == 200:
        try:
            data = json.loads(content.decode("utf-8", errors="replace"))
```
